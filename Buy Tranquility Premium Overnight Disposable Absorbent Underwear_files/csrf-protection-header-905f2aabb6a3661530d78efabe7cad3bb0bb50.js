!function(){if(!window._bcCsrfProtectionPatched){window._bcCsrfProtectionPatched=!0;var e=Object.getPrototypeOf(new window.XMLHttpRequest),t=e.open,n=e.send,s=e.setRequestHeader;if(e.open=function(){return this._isLocalRequest=a(arguments[1]),this._isAssetRequest=u(arguments[0],arguments[1]),t.apply(this,arguments)},e.send=function(){if(this._isLocalRequest&&!this._isAssetRequest){var e=o(),t=o("SF-CSRF-TOKEN");e&&!this._hasCsrfToken&&this.setRequestHeader("X-XSRF-TOKEN",e),t&&!this._hasSfCsrfToken&&this.setRequestHeader("X-SF-CSRF-TOKEN",t)}return n.apply(this,arguments)},e.setRequestHeader=function(){return"X-XSRF-TOKEN"===arguments[0]&&arguments[1]&&(this._hasCsrfToken=!0),"X-SF-CSRF-TOKEN"===arguments[0]&&arguments[1]&&(this._hasSfCsrfToken=!0),s.apply(this,arguments)},window.$&&window.$.fn&&window.$.fn.jquery?$(document).submit(d):document.addEventListener("submit",d),window.fetch){var i=window.fetch;window.fetch=function(e,t){if(window.Request){var n=new Request(e,t);return a(n.url)&&!u(n.method,n.url)&&h(n),i(n)}var s=e,r=t||{};return a(s)&&!u(r.method,s)&&h(r),i(s,r)}}var r=[new RegExp("^"+window.location.origin+"/wishlist.php"),new RegExp("^/?wishlist.php")]}function o(e="XSRF-TOKEN"){for(var t=document.cookie.split("; "),n=0;n<t.length;n++){var s=t[n].split("="),i=s[0],r=s[1];if(e===i)return r}return""}function a(e){return!!e.match(new RegExp("^(https?:)?//"+window.location.hostname))||!e.match(new RegExp("^(https?:)?//"))}function u(e,t){return(!e||"GET"===e.toUpperCase())&&/\.(png|gif|jpe?g|css|js|json|svg|html?)$/.test(t.split("?")[0])}function h(e){e.headers=e.headers||{};var t=o(),n=o("SF-CSRF-TOKEN");e.headers.append?(t&&(e.headers.delete("X-XSRF-TOKEN"),e.headers.append("X-XSRF-TOKEN",t)),n&&(e.headers.delete("X-SF-CSRF-TOKEN"),e.headers.append("X-SF-CSRF-TOKEN",n))):(t&&(e.headers["X-XSRF-TOKEN"]=t),n&&(e.headers["X-SF-CSRF-TOKEN"]=n))}function d(e){var t=document.createElement("input"),n=e.target.getAttribute("action");null!=n&&function(e,t){for(var n=0;n<t.length;n++)if(e&&e.match(t[n]))return!0;return!1}(n,r)&&(e.target.method="POST"),e.target.querySelector('input[name="authenticity_token"]')||"post"===e.target.method.toLowerCase()&&(t.setAttribute("type","hidden"),t.setAttribute("name","authenticity_token"),t.setAttribute("value",o()),e.target.appendChild(t))}}();
//# sourceMappingURL=csrf-protection-header-905f2aabb6a3661530d78efabe7cad3bb0bb508d.js.map
